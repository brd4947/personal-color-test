<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>í¼ìŠ¤ë„ ì»¬ëŸ¬ ì‹¤ì‹œê°„ ì§„ë‹¨</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      padding: 40px;
      max-width: 600px;
      margin: auto;
      background: #f5f5f5;
      text-align: center;
    }
    h1 {
      font-size: 32px;
      margin-bottom: 30px;
    }
    video, canvas {
      width: 100%;
      max-width: 400px;
      border-radius: 10px;
      margin-bottom: 20px;
    }
    button {
      padding: 12px 24px;
      font-size: 16px;
      background-color: #90caf9;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      transition: 0.3s ease;
    }
    button:hover {
      background-color: #64b5f6;
    }
    .result {
      margin-top: 30px;
      font-size: 22px;
      font-weight: bold;
    }
    .color-palette {
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      gap: 10px;
      margin-top: 20px;
    }
    .swatch {
      width: 30px;
      height: 30px;
      border-radius: 6px;
      border: 1px solid #ccc;
    }
  </style>
</head>
<body>
  <h1>ğŸ“· ì‹¤ì‹œê°„ í¼ìŠ¤ë„ ì»¬ëŸ¬ í…ŒìŠ¤íŠ¸</h1>
  <video id="video" autoplay playsinline></video>
  <br>
  <button onclick="captureAndAnalyze()">ì‹¤ì‹œê°„ ë¶„ì„</button>

  <div class="result" id="result"></div>
  <canvas id="canvas" style="display: none;"></canvas>

  <script>
    const video = document.getElementById('video');

    navigator.mediaDevices.getUserMedia({ video: true })
      .then(stream => {
        video.srcObject = stream;
      })
      .catch(err => {
        alert("ì¹´ë©”ë¼ì— ì ‘ê·¼í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤: " + err);
      });

    function captureAndAnalyze() {
      const canvas = document.getElementById('canvas');
      const resultEl = document.getElementById('result');
      const context = canvas.getContext('2d');

      canvas.width = video.videoWidth;
      canvas.height = video.videoHeight;
      context.drawImage(video, 0, 0, canvas.width, canvas.height);

      const { r, g, b } = getAverageColor(context, canvas.width, canvas.height);
      
      const simulatedTone = determineColorTone(r, g, b);
      let resultText = "";
      let palette = [];

      if (simulatedTone === 'spring') {
        resultText = "ğŸŒ¸ ë‹¹ì‹ ì€ <strong>ë´„ ì›œí†¤</strong>ì…ë‹ˆë‹¤! ìƒê¸° ìˆê³  í™”ì‚¬í•œ ìƒ‰ìƒì´ ì–´ìš¸ë ¤ìš”.";
        palette = ["#FFDAB9", "#FFFACD", "#FFB6C1", "#F08080"];
      } else if (simulatedTone === 'autumn') {
        resultText = "ğŸ ë‹¹ì‹ ì€ <strong>ê°€ì„ ì›œí†¤</strong>ì…ë‹ˆë‹¤! ë”°ëœ»í•˜ê³  ì•ˆì •ê° ìˆëŠ” ì»¬ëŸ¬ê°€ ì–´ìš¸ë ¤ìš”.";
        palette = ["#D2691E", "#A0522D", "#CD853F", "#B8860B"];
      } else if (simulatedTone === 'summer') {
        resultText = "ğŸŒŠ ë‹¹ì‹ ì€ <strong>ì—¬ë¦„ ì¿¨í†¤</strong>ì…ë‹ˆë‹¤! ë¶€ë“œëŸ½ê³  ì€ì€í•œ ìƒ‰ì´ ì˜ ì–´ìš¸ë¦½ë‹ˆë‹¤.";
        palette = ["#B0E0E6", "#AFEEEE", "#E6E6FA", "#D8BFD8"];
      } else {
        resultText = "â„ï¸ ë‹¹ì‹ ì€ <strong>ê²¨ìš¸ ì¿¨í†¤</strong>ì…ë‹ˆë‹¤! ì„ ëª…í•˜ê³  ê°•ë ¬í•œ ìƒ‰ì´ ì˜ ì–´ìš¸ë ¤ìš”.";
        palette = ["#000080", "#8B008B", "#2F4F4F", "#4682B4"];
      }

      resultEl.innerHTML = resultText;
      if (palette.length) {
        const paletteContainer = document.createElement("div");
        paletteContainer.className = "color-palette";
        palette.forEach(color => {
          const swatch = document.createElement("div");
          swatch.className = "swatch";
          swatch.style.backgroundColor = color;
          paletteContainer.appendChild(swatch);
        });
        resultEl.appendChild(paletteContainer);
      }
    }

    function getAverageColor(context, width, height) {
      const imageData = context.getImageData(0, 0, width, height);
      const data = imageData.data;
      let r = 0, g = 0, b = 0;
      const length = data.length / 4;

      for (let i = 0; i < data.length; i += 4) {
        r += data[i];   // Red
        g += data[i+1]; // Green
        b += data[i+2]; // Blue
      }

      r = Math.floor(r / length);
      g = Math.floor(g / length);
      b = Math.floor(b / length);

      return { r, g, b };
    }

    function determineColorTone(r, g, b) {
      // ê¸°ì¤€ì„ ì„¤ì •í•˜ì—¬ ìƒ‰ì„ ë¶„ë¥˜í•©ë‹ˆë‹¤.
      if (r > 180 && g < 140 && b < 150) {
        return 'spring';  // ë´„ ì›œí†¤
      } else if (r > 160 && g < 140 && b < 120) {
        return 'autumn';  // ê°€ì„ ì›œí†¤
      } else if (r < 120 && g > 150 && b > 150) {
        return 'summer';  // ì—¬ë¦„ ì¿¨í†¤
      } else {
        return 'winter';  // ê²¨ìš¸ ì¿¨í†¤
      }
    }
  </script>
</body>
</html>
